import { toast } from 'react-toastify';
import { Button } from './button';
import { useNavigate } from 'react-router-dom';

interface CourseCardProps {
  kode: string;
  name: string;
  id: string;
  onAction: () => void;
}

const CourseCard: React.FC<CourseCardProps> = ({ kode, name, id, onAction }) => {
  const navigate = useNavigate();

  const deleteCourse = () => {
    fetch(`${import.meta.env.VITE_REST_SERVICE}/courses/${id}`, {
      method: "DELETE",
      headers: {
        "Authorization": `Bearer ${localStorage.getItem("token")}`,
      }
    }).then((res) => res.json()).then((res) => {
      if (res.status === "success") {
        toast.success(res.message);
        onAction();
      } else {
        toast.error(res.message);
      }
    }).catch((error) => {
      toast.error(error);
    });
  };

  return (
    <div className='flex px-3 flex-col justify-center items-center'>
      <div className='flex flex-col items-center rounded-xl bg-white'>
        <div className='flex px-11 py-8 justify-center items-start gap-3'>
          <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 60 60" fill="none">
            <path d="M52.845 45.7957C55.0104 46.973 56.8181 48.7127 58.0774 50.8315C59.3366 52.9502 60.0008 55.3694 60 57.8341C60 58.4077 59.7721 58.9579 59.3665 59.3635C58.9608 59.7691 58.4107 59.997 57.837 59.997C57.2633 59.997 56.7132 59.7691 56.3075 59.3635C55.9019 58.9579 55.674 58.4077 55.674 57.8341C55.674 56.603 55.4315 55.384 54.9604 54.2466C54.4892 53.1093 53.7987 52.0758 52.9281 51.2053C52.0576 50.3348 51.0241 49.6443 49.8867 49.1732C48.7492 48.7021 47.5301 48.4596 46.299 48.4596C45.0679 48.4596 43.8488 48.7021 42.7113 49.1732C41.5739 49.6443 40.5404 50.3348 39.6699 51.2053C38.7993 52.0758 38.1088 53.1093 37.6376 54.2466C37.1665 55.384 36.924 56.603 36.924 57.8341C36.924 58.4081 36.696 58.9587 36.29 59.3646C35.8841 59.7705 35.3336 59.9985 34.7595 59.9985C34.1854 59.9985 33.6349 59.7705 33.229 59.3646C32.823 58.9587 32.595 58.4081 32.595 57.8341C32.595 52.6384 35.49 48.1146 39.75 45.7957C38.4159 44.494 37.5002 42.8241 37.1198 40.9995C36.7394 39.1748 36.9116 37.2782 37.6143 35.5519C38.3171 33.8256 39.5185 32.3479 41.0652 31.3076C42.6119 30.2674 44.4335 29.7118 46.2975 29.7118C48.1615 29.7118 49.9831 30.2674 51.5298 31.3076C53.0765 32.3479 54.2779 33.8256 54.9807 35.5519C55.6834 37.2782 55.8556 39.1748 55.4752 40.9995C55.0948 42.8241 54.1791 44.494 52.845 45.7957ZM46.299 44.1338C47.6381 44.1338 48.9223 43.6019 49.8692 42.6551C50.8161 41.7082 51.348 40.4241 51.348 39.0851C51.348 37.746 50.8161 36.4619 49.8692 35.515C48.9223 34.5682 47.6381 34.0363 46.299 34.0363C44.9599 34.0363 43.6757 34.5682 42.7288 35.515C41.782 36.4619 41.25 37.746 41.25 39.0851C41.25 40.4241 41.782 41.7082 42.7288 42.6551C43.6757 43.6019 44.9599 44.1338 46.299 44.1338ZM39.585 24.6918H11.085C9.795 24.6918 9 23.8368 9 22.4419C9 21.047 9.795 20.192 11.088 20.192H39.585C40.875 20.192 41.67 21.047 41.67 22.4419C41.67 23.8368 40.875 24.6918 39.585 24.6918ZM27.372 34.7953H11.088C9.798 34.7953 9 33.9403 9 32.5454C9 31.1504 9.795 30.2955 11.088 30.2955H27.372C28.662 30.2955 29.457 31.1504 29.457 32.5454C29.457 33.9403 28.662 34.7953 27.372 34.7953ZM27 55.3832C27.3129 55.3673 27.6257 55.4151 27.9195 55.5238C28.2133 55.6326 28.4819 55.7999 28.709 56.0157C28.936 56.2315 29.1169 56.4912 29.2404 56.779C29.364 57.0669 29.4277 57.3769 29.4277 57.6901C29.4277 58.0034 29.364 58.3133 29.2404 58.6012C29.1169 58.889 28.936 59.1488 28.709 59.3645C28.4819 59.5803 28.2133 59.7477 27.9195 59.8564C27.6257 59.9651 27.3129 60.013 27 59.997H8.487C6.23981 60.0002 4.08335 59.1108 2.49181 57.5244C0.900276 55.938 0.00397508 53.7845 0 51.5374V8.45959C0.00397508 6.21251 0.900276 4.059 2.49181 2.47261C4.08335 0.886217 6.23981 -0.00317192 8.487 1.32984e-05H45.51C46.623 -0.00195818 47.7254 0.215291 48.7544 0.639358C49.7834 1.06342 50.7188 1.686 51.5071 2.47155C52.2955 3.25709 52.9214 4.19022 53.3491 5.21765C53.7769 6.24508 53.998 7.34669 54 8.45959V23.8458C54 24.4596 53.7562 25.0483 53.3221 25.4823C52.888 25.9164 52.2993 26.1602 51.6855 26.1602C51.0717 26.1602 50.483 25.9164 50.0489 25.4823C49.6148 25.0483 49.371 24.4596 49.371 23.8458V8.45959C49.371 6.3327 47.646 4.61078 45.513 4.61078H8.49C6.36 4.61078 4.632 6.3327 4.632 8.45959V51.5314C4.632 53.6583 6.357 55.3802 8.49 55.3802H27V55.3832Z" fill="#979797" />
          </svg>
        </div>
        <div className='flex p-3 flex-col items-start self-stretch'>
          <p className='self-stretch text-gray-500 overflow-hidden overflow-ellipsis text-[10px] font-normal'>
            {kode}
          </p>
          <p className='self-stretch overflow-hidden overflow-ellipsis text-xs font-medium'>
            {name}
          </p>
          <div className='flex pt-4 justify-center items-center gap-4 self-stretch'>
            <Button
              className='flex px-4 py-1 flex-col justify-center items-end gap-3 rounded-lg bg-blue-500 text-white font-bold text-[10px]'
              onClick={(_) => {
                localStorage.setItem("courseId", id);
                navigate(`/courses/${id}`);
              }
              }>
              LIHAT
            </Button>
            <button
              className='flex justify-center items-center gap-3'
              onClick={(_) => navigate(`/courses/${id}/edit`)
              }>
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="15" viewBox="0 0 16 15" fill="none">
                <path d="M14.3977 0.48621C13.7495 -0.16207 12.7015 -0.16207 12.0533 0.48621L11.1623 1.37427L14.0603 4.27229L14.9513 3.38127C15.5996 2.73299 15.5996 1.68509 14.9513 1.0368L14.3977 0.48621ZM5.54086 6.99862C5.36029 7.17919 5.22116 7.4012 5.14123 7.6469L4.26502 10.2755C4.17917 10.5301 4.24726 10.8113 4.43671 11.0037C4.62616 11.1962 4.90738 11.2613 5.16492 11.1754L7.79356 10.2992C8.0363 10.2193 8.25831 10.0802 8.44184 9.8996L13.3942 4.94425L10.4933 2.04327L5.54086 6.99862ZM3.27928 1.73837C1.71038 1.73837 0.4375 3.01125 0.4375 4.58015V12.1582C0.4375 13.7271 1.71038 15 3.27928 15H10.8574C12.4263 15 13.6991 13.7271 13.6991 12.1582V9.31644C13.6991 8.79249 13.2758 8.36918 12.7519 8.36918C12.2279 8.36918 11.8046 8.79249 11.8046 9.31644V12.1582C11.8046 12.6822 11.3813 13.1055 10.8574 13.1055H3.27928C2.75533 13.1055 2.33202 12.6822 2.33202 12.1582V4.58015C2.33202 4.05619 2.75533 3.63289 3.27928 3.63289H6.12106C6.64501 3.63289 7.06832 3.20958 7.06832 2.68563C7.06832 2.16168 6.64501 1.73837 6.12106 1.73837H3.27928Z" fill="black" />
              </svg>
            </button>
            <button className='flex justify-center items-center gap-3' onClick={(_) => deleteCourse()}>
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="15" viewBox="0 0 14 15" fill="none">
                <path d="M4.39844 0.518555L4.1875 0.9375H1.375C0.856445 0.9375 0.4375 1.35645 0.4375 1.875C0.4375 2.39355 0.856445 2.8125 1.375 2.8125H12.625C13.1436 2.8125 13.5625 2.39355 13.5625 1.875C13.5625 1.35645 13.1436 0.9375 12.625 0.9375H9.8125L9.60156 0.518555C9.44336 0.199219 9.11816 0 8.76367 0H5.23633C4.88184 0 4.55664 0.199219 4.39844 0.518555ZM12.625 3.75H1.375L1.99609 13.6816C2.04297 14.4229 2.6582 15 3.39941 15H10.6006C11.3418 15 11.957 14.4229 12.0039 13.6816L12.625 3.75Z" fill="black" />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  )
};

export default CourseCard;
